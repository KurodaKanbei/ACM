\begin{lstlisting}
LL solve(LL n, LL a, LL b, LL m){
	//计算for (int i=0;i<n;++i) s+=floor((a+b*i)/m)
	//n,m,a,b>0
	//printf("%lld %lld %lld %lld\n", n, a, b, m);
	if(b == 0){
		return n * (a / m);
	}
	if(a >= m){
		return n * (a / m) + solve(n, a % m, b, m);
	}
	if(b >= m){
		return (n - 1) * n / 2 * (b / m) + solve(n, a, b % m, m);
	}
	LL q = (a + b * n) / m;
	return solve(q, (a + b * n) % m, m, b);
}
\end{lstlisting}
